{% extends "layout.html" %}

{% block content %}

<!-- Banner del juego -->
<header class="container-fluid p-0">
    <img src="{{ url_for('static', filename='images/Mad_Father/banner.jpg') }}" class="img-fluid w-100" alt="Mad_Father">
</header>

<!-- Contenido principal -->
<div class="container my-5">
    <!-- Encabezado -->
    <div class="jumbotron">
        <div class="container">
            <h1 class="display-4">Mad Father</h1>
            <p class="lead">Survival horror RPG donde una niña de 11 años, explora la mansión de su padre para descubrir 
                oscuros secretos y enfrentar horrores sobrenaturales.</p>
            <hr class="my-4">
            <div class="d-flex align-items-center">
                <span class="badge bg-purple me-2">Survival Horror</span>
                <span class="badge bg-purple me-2">RPG</span>
                <span class="badge bg-purple">Puzles</span>
            </div>
        </div>
    </div>

    <!-- Sección de reseña -->
    <article class="review-content">
        <div class="row">
            <div class="col-md-8">
                <h2 class="section-tittle">Reseña</h2>
                <div class="review-section mb-5">
                    <h3>Un oscuro viaje familiar</h3>
                    <p>Aya Drevis vive con su padre y su sirvienta en una mansión en Alemania. Tras escuchar gritos en el laboratorio, descubre horrores y 
                        secretos macabros relacionados con los experimentos de su padre, enfrentando criaturas y enigmas para salvarlo y desvelar la verdad.</p>
                  <img src="{{ url_for('static', filename='images/Mad_Father/gameplay.jpg') }}" class="img-fluid rounded my-3 d-block mx-auto" alt="Gameplay">
                </div>

                <div class="review-section mb-5">
                    <h3>Exploración</h3>
                    <p>El jugador debe explorar la mansión, recolectar objetos y resolver puzles para avanzar, mientras evita o enfrenta criaturas sobrenaturales 
                        que acechan en los pasillos, combinando tensión y estrategia.</p>
                    <div class="game-features">
                        <div class="feature">
                            <i class="fas fa-bolt"></i>
                            <h4>Inventario</h4>
                            <p>Combina y utiliza objetos para resolver puzles y abrir caminos</p>
                        </div>
                        <div class="feature">
                            <i class="fas fa-chess"></i>
                            <h4>Múltiples finales</h4>
                            <p>Las decisiones y acciones afectan el desenlace, con varios finales posibles según elecciones y coleccionables</p>
                        </div>
                    </div>
                </div>

                <div class="review-section mb-5">
                    <h3>Arte y banda sonora</h3>
                    <p>Mad Father utiliza un estilo pixel art retro que evoca los clásicos RPG, con un diseño oscuro y gótico que refuerza la atmósfera de terror y misterio. 
                        Los personajes y escenarios están detallados para crear un ambiente inquietante y envolvente.<br><br>La banda sonora es minimalista pero efectiva, 
                        alternando temas tranquilos con melodías tensas que aumentan la sensación de suspense y peligro. Los efectos sonoros, como gritos y ruidos ambientales, 
                        contribuyen a la inmersión y al clima de ansiedad constante que caracteriza al juego.</p>
                    <img src="{{ url_for('static', filename='images/Mad_Father/art.jpg') }}" class="img-fluid rounded my-3" alt="Arte conceptual">
                </div>

                <div class="pros-cons">
                    <div class="pros">
                        <h4><i class="fas fa-check-circle"></i> Puntos fuertes</h4>
                        <ul>
                            <li>Narrativa intensa y emotiva con giros sorprendentes</li>
                            <li>Buena ambientación y atmósfera de terrorífica</li>
                            <li>Puzles desafiantes que requieren atención y estrategia</li>
                            <li>Personajes memorables con desarrollo psicológico</li>
                        </ul>
                    </div>
                    <div class="cons">
                        <h4><i class="fas fa-times-circle"></i> Puntos débiles</h4>
                        <ul>
                            <li>Gráficos simples</li>
                            <li>Algunas mecánicas pueden sentirse básicas o repetitivas</li>
                            <li>Ritmo irregular en momentos de la historia</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Sidebar con información del juego -->
            <div class="col-md-4">
                <div class="game-info-card">
                    <img src="{{ url_for('static', filename='images/Mad_Father/cover.jpg') }}" class="img-fluid rounded-top" alt="Portada">
                    <div class="game-info-body">
                        <h3>Información del Juego</h3>
                        <div class="info-item">
                            <span class="info-label">Desarrollador:</span>
                            <span class="info-value">Sen</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Género:</span>
                            <span class="info-value">Survival Horror</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Plataformas:</span>
                            <span class="info-value">PC, Switch</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Lanzamiento:</span>
                            <span class="info-value">2012 (Org.) 2016 (Remake)</span>
                        </div>
                        <div class="rating">
                            <div class="stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                            </div>
                            <span class="score">4.5/5</span>
                        </div>

<div class="soundtrack-player mt-4">
                            <h4><i class="fas fa-music"></i> Banda Sonora</h4>
                            <div class="player-container">
                                <audio id="gameSoundtrack" controls autoplay>
                                    <source src="{{ url_for('static', filename='audio/Shudder.mp3') }}" type="audio/mpeg">
                                    <source src="{{ url_for('static', filename='audio/Game Over.ogg') }}" type="audio/ogg">
                                    Tu navegador no soporta el elemento de audio.
                                </audio>
                                <div class="track-list mt-3">
                                    <div class="track active" data-track-src="{{ url_for('static', filename='audio/Shudder.mp3') }}">
                                        <span class="track-number">1</span>
                                        <span class="track-title">Shudder</span>
                                        <span class="track-duration">0:48</span>
                                    </div>
                                    <div class="track" data-track-src="{{ url_for('static', filename='audio/Game Over.mp3') }}">
                                        <span class="track-number">2</span>
                                        <span class="track-title">Game Over</span>
                                        <span class="track-duration">00:28</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <a href="https://www.youtube.com/watch?v=V3jrnDe_8GM" class="btn btn-primary btn-block mt-3">Ver tráiler</a>
                        <a href="https://store.steampowered.com/app/483980/Mad_Father/" class="btn btn-outline-primary btn-block">Comprar ahora</a>
                    </div>
                </div>
            </div>
        </div>
    </article>
</div>

<!-- Script del reproductor -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const audioPlayer = document.getElementById('gameSoundtrack');
    const tracks = document.querySelectorAll('.track');
    
    // Configuración inicial
    audioPlayer.src = document.querySelector('.track.active').dataset.trackSrc;
    
    // Cambiar canción al hacer clic
    tracks.forEach(track => {
        track.addEventListener('click', function() {
            // Remover clase active de todas las pistas
            tracks.forEach(t => t.classList.remove('active'));
            
            // Añadir clase active a la pista seleccionada
            this.classList.add('active');
            
            // Cambiar la fuente de audio
            const newTrackSrc = this.dataset.trackSrc;
            if (audioPlayer.src !== newTrackSrc) {
                audioPlayer.src = newTrackSrc;
                audioPlayer.currentTime = 0;
            }
            
            // Reproducir automáticamente (con manejo de errores)
            audioPlayer.play().catch(e => {
                console.log("Error de reproducción:", e);
                // Muestra un botón de play si falla la reproducción automática
                const playBtn = document.createElement('button');
                playBtn.className = 'btn btn-sm btn-primary mt-2';
                playBtn.innerHTML = '<i class="fas fa-play"></i> Reproducir';
                playBtn.onclick = () => audioPlayer.play();
                this.appendChild(playBtn);
            });
        });
    });
    
    // Manejar el fin de la reproducción
    audioPlayer.addEventListener('ended', function() {
        const currentActive = document.querySelector('.track.active');
        const nextTrack = currentActive.nextElementSibling || tracks[0];
        
        currentActive.classList.remove('active');
        nextTrack.classList.add('active');
        audioPlayer.src = nextTrack.dataset.trackSrc;
        audioPlayer.play();
    });
    
    // Solución para políticas de autoplay (requiere interacción del usuario)
    document.addEventListener('click', function initAudio() {
        // Solo necesita ejecutarse una vez
        document.removeEventListener('click', initAudio);
        
        // Precarga el audio
        audioPlayer.volume = 0;
        audioPlayer.play().then(() => {
            audioPlayer.pause();
            audioPlayer.currentTime = 0;
            audioPlayer.volume = 1;
        }).catch(e => console.log("Precarga de audio:", e));
    }, { once: true });
});
</script>

{% endblock %}